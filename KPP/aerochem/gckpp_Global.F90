! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! Global Data Module File
! 
! Generated by KPP-2.3.2_gc symbolic chemistry Kinetics PreProcessor
!       (http://www.cs.vt.edu/~asandu/Software/KPP)
! KPP is distributed under GPL, the general public licence
!       (http://www.gnu.org/copyleft/gpl.html)
! (C) 1995-1997, V. Damian & A. Sandu, CGRER, Univ. Iowa
! (C) 1997-2005, A. Sandu, Michigan Tech, Virginia Tech
!     With important contributions from:
!        M. Damian, Villanova University, USA
!        R. Sander, Max-Planck Institute for Chemistry, Mainz, Germany
! 
! File                 : gckpp_Global.F90
! Equation file        : gckpp.kpp
! Output root filename : gckpp
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



MODULE gckpp_Global

  USE gckpp_Parameters, ONLY: dp, NSPEC, NVAR, NFIX, NREACT
  PUBLIC
  SAVE


! Declaration of global variables

! These quantities vary with lon/lat/lev location.
! They must be declared THREADPRIVATE for the parallel
! loop over all cells in the chemistry grid.

! C - Concentration of all species
  REAL(kind=dp) :: C(NSPEC)
  !$OMP THREADPRIVATE( C )
! VAR - Concentrations of variable species (global)
  REAL(kind=dp) :: VAR(NVAR)
  !$OMP THREADPRIVATE( VAR )
! FIX - Concentrations of fixed species (global)
  REAL(kind=dp) :: FIX(NFIX)
  !$OMP THREADPRIVATE( FIX )
! RCONST - Rate constants (global)
  REAL(kind=dp) :: RCONST(NREACT)
  !$OMP THREADPRIVATE( RCONST )
! TIME - Current integration time
  REAL(kind=dp) :: TIME
  !$OMP THREADPRIVATE( TIME )
! TEMP - Temperature
  REAL(kind=dp) :: TEMP
  !$OMP THREADPRIVATE( TEMP )
! SR_TEMP - Square root of Temperature [K**0.5]
  REAL(kind=dp) :: SR_TEMP
  !$OMP THREADPRIVATE( SR_TEMP )
! TEMP_OVER_K300 - Temperature [K] / 300.0
  REAL(kind=dp) :: TEMP_OVER_K300
  !$OMP THREADPRIVATE( TEMP_OVER_K300 )
! K300_OVER_TEMP - 300.0 / Temperature [K]
  REAL(kind=dp) :: K300_OVER_TEMP
  !$OMP THREADPRIVATE( K300_OVER_TEMP )
! CFACTOR - Conversion factor for concentration units
  REAL(kind=dp) :: CFACTOR
  !$OMP THREADPRIVATE( CFACTOR )
! NUMDEN - Air number density [#/cm3]
  REAL(kind=dp) :: NUMDEN
  !$OMP THREADPRIVATE( NUMDEN )

! These variables do not vary with location, and can be
! assigned outside of the parallel loop over cells in the
! chemistry grid.  These do not need to be THREADPRIVATE.

! MW - Species molecular weight [g/mole]
  REAL(kind=dp) :: MW(NSPEC)
! SR_MW - Square root of species molecular weight [g/mole]
  REAL(kind=dp) :: SR_MW(NSPEC)
! RTOLS - (scalar) Relative tolerance
  REAL(kind=dp) :: RTOLS
! TSTART - Integration start time
  REAL(kind=dp) :: TSTART
! TEND - Integration end time
  REAL(kind=dp) :: TEND
! DT - Integration step
  REAL(kind=dp) :: DT
! ATOL - Absolute tolerance
  REAL(kind=dp) :: ATOL(NVAR)
! RTOL - Relative tolerance
  REAL(kind=dp) :: RTOL(NVAR)
! STEPMIN - Lower bound for integration step
  REAL(kind=dp) :: STEPMIN
! STEPMAX - Upper bound for integration step
  REAL(kind=dp) :: STEPMAX

! INLINED global variable declarations

  !-----------------------------------------------------------------------
  ! Add global parameters here -- these will go into gckpp_Global.F90
  !-----------------------------------------------------------------------

  ! Debug box (change if necessary)
  INTEGER,  PARAMETER :: I_dbg         = 50
  INTEGER,  PARAMETER :: J_dbg         = 2
  INTEGER,  PARAMETER :: L_dbg         = 44

  ! Indices for aerosol type (1 .. NAEROTYPE=14)
  INTEGER,  PARAMETER :: DU1           = 1   ! Dust (Reff = 0.151 um)
  INTEGER,  PARAMETER :: DU2           = 2   ! Dust (Reff = 0.253 um)
  INTEGER,  PARAMETER :: DU3           = 3   ! Dust (Reff = 0.402 um)
  INTEGER,  PARAMETER :: DU4           = 4   ! Dust (Reff = 0.818 um)
  INTEGER,  PARAMETER :: DU5           = 5   ! Dust (Reff = 1.491 um)
  INTEGER,  PARAMETER :: DU6           = 6   ! Dust (Reff = 2.417 um)
  INTEGER,  PARAMETER :: DU7           = 7   ! Dust (Reff = 3.721 um)
  INTEGER,  PARAMETER :: SUL           = 8   ! Tropospheric Sulfate
  INTEGER,  PARAMETER :: BKC           = 9   ! Black Carbon
  INTEGER,  PARAMETER :: ORC           = 10  ! Organic Carbon
  INTEGER,  PARAMETER :: SSA           = 11  ! Accum-mode (fine) sea salt
  INTEGER,  PARAMETER :: SSC           = 12  ! Coarse sea salt
  INTEGER,  PARAMETER :: SLA           = 13  ! Strat sulfate liq aerosol
  INTEGER,  PARAMETER :: IIC           = 14  ! Irregular ice cloud

  ! Indices for Fine and coarse sea-salt indices
  INTEGER,  PARAMETER :: SS_FINE        = 1
  INTEGER,  PARAMETER :: SS_COARSE      = 2

  ! Indices for the KHETI_SLA array
  INTEGER,  PARAMETER :: N2O5_plus_H2O  = 1
  INTEGER,  PARAMETER :: N2O5_plus_HCl  = 2
  INTEGER,  PARAMETER :: ClNO3_plus_H2O = 3
  INTEGER,  PARAMETER :: ClNO3_plus_HCl = 4
  INTEGER,  PARAMETER :: ClNO3_plus_HBr = 5
  INTEGER,  PARAMETER :: BrNO3_plus_H2O = 6
  INTEGER,  PARAMETER :: BrNO3_plus_HCl = 7
  INTEGER,  PARAMETER :: HOCl_plus_HCl  = 8
  INTEGER,  PARAMETER :: HOCl_plus_HBr  = 9
  INTEGER,  PARAMETER :: HOBr_plus_HCl  = 10
  INTEGER,  PARAMETER :: HOBr_plus_HBr  = 11

  ! Minimum heterogeneous chemistry lifetime and reaction rate
  REAL(dp), PARAMETER :: HET_MIN_LIFE   = 1.e-3_dp
  REAL(dp), PARAMETER :: HET_MIN_RATE   = 1.0_dp / HET_MIN_LIFE

  ! Critical RH [%] for uptake of GLYX, MGLYX, and GLYC:
  REAL(dp), PARAMETER :: CRITRH         = 35.0_dp

  ! Conversion factor from atm to bar
  REAL(dp), PARAMETER :: CON_ATM_BAR    = 1.0_dp / 1.01325_dp

  ! Universal gas consatant [bar/(mol/kg)/K]  (Source: NIST, 2014)
  ! NOTE: Make sure this is consistent w/ the value in physconsts.F90!
  REAL(dp), PARAMETER :: CON_R          = 0.083144598_dp

  ! Reference temperature used in Henry's law
  REAL(dp), PARAMETER :: INV_T298       = 1.0_dp / 298.15_dp

  !--------------------------------------------------------------------------
  ! Additional global variables -- will be added to gckpp_Global.F90
  !--------------------------------------------------------------------------

  ! Inverse of temperature [K]
  REAL(dp) :: INV_TEMP
  !$OMP THREADPRIVATE( INV_TEMP )

  ! 4.0 * CON_R * TEMP
  REAL(dp) :: FOUR_R_T
  !$OMP THREADPRIVATE( FOUR_R_T )

  ! 4.0 * RGASLATM * TEMP
  REAL(dp) :: FOUR_RGASLATM_T
  !$OMP THREADPRIVATE( FOUR_RGASLATM_T )

  ! 8.0 * RSTARG * TEMP
  REAL(dp) :: EIGHT_RSTARG_T
  !$OMP THREADPRIVATE( EIGHT_RSTARG_T )

  ! H2O concentration
  REAL(dp) :: H2O
  !$OMP THREADPRIVATE( H2O )

  ! Pressure and relative humidity
  REAL(dp) :: PRESS
  REAL(dp) :: RELHUM
  !$OMP THREADPRIVATE( PRESS, RELHUM )

  ! Cosine of solar zenith angle
  REAL(dp) :: SUNCOS
  !$OMP THREADPRIVATE( SUNCOS )

  ! Henry's law constants (do not need to be THREADPRIVATE)
  REAL(dp) :: HENRY_K0(NSPEC)
  REAL(dp) :: HENRY_CR(NSPEC)

  ! Array for aqueous rates
  ! - number of reactions set to 20 arbitrarily
  REAL(kind=dp) :: K_MT(20)
  !$OMP THREADPRIVATE( K_MT )

  ! Array for cloud rates
  ! - number of reactions set to 20 arbitrarily
  REAL(kind=dp) :: K_CLD(20)
  !$OMP THREADPRIVATE( K_CLD )

  ! Array for dust acid-uptake reates
  ! - number of reactions set to 20 arbitrarily
  REAL(kind=dp) :: K_DST(20)
  !$OMP THREADPRIVATE( K_DST )

  ! Liquid water conversion factor
  ! - Size = number of aerosol types (nAeroType)
  REAL(kind=dp) :: CVFAC(14)
  !$OMP THREADPRIVATE( CVFAC )

  ! Proton activity [unitless] and H+ concentration [M]
  ! (assumed equivalent - for now):
  REAL(kind=dp) :: H_PLUS
  !$OMP THREADPRIVATE( H_PLUS )

  !### NOTE: The HET array is deprecated
  !### These are the only slots left to convert
  ! Array for heterogeneous rates
  ! HET(ind_ClNO2,  1) : ClNO2  +  SALACL
  ! HET(ind_ClNO2,  2) : ClNO2  +  SALCCL
  ! HET(ind_ClNO2,  3) : ClNO3  +  HCl          # in-cloud only
  ! HET(ind_ClNO2,  4) : ClNO2  +  BrSALA
  ! HET(ind_ClNO2,  5) : ClNO2  +  BrSALC
  ! HET(ind_ClNO2,  6) : ClNO2  +  HBr          # in-cloud only
  ! HET(ind_ClNO3,  1) : ClNO3  +  H2O          # hydrolysis rxn
  ! HET(ind_ClNO3,  2) : ClNO3  +  HCl
  ! HET(ind_ClNO3,  3) : ClNO3  +  HBr
  ! HET(ind_ClNO3,  4) : ClNO3  +  BrSALA
  ! HET(ind_ClNO3,  5) : ClNO3  +  BrSALC
  ! HET(ind_ClNO3,  6) : ClNO3  +  SALACL
  ! HET(ind_ClNO3,  7) : CLNO3  +  SALCCL
  ! HET(ind_HOBr,   1) : HOBr   +  HBr
  ! HET(ind_HOBr,   2) : HOBr   +  HCl
  ! HET(ind_HOBr,   3) : HOBr   +  SALACL
  ! HET(ind_HOBr,   4) : HOBr   +  SALCCL
  ! HET(ind_HOBr,   5) : HOBr   +  BrSALA
  ! HET(ind_HOBr,   6) : HOBr   +  BrSALC
  ! HET(ind_HOBr,   7) : HOBr   +  HSO3-(aq)
  ! HET(ind_HOBr,   8) : HOBr   +  HSO3--(aq)
  ! HET(ind_HOCl,   1) : HOCl   +  HCl
  ! HET(ind_HOCl,   2) : HOCl   +  HBr
  ! HET(ind_HOCl,   3) : HOCl   +  SALACL
  ! HET(ind_HOCl,   4) : HOCl   +  SALCCL
  ! HET(ind_HOCl,   5) : HOCl   +  HSO3--(aq)
  ! HET(ind_HOCl,   6) : HOCl   +  SO3--(aq)
  REAL(kind=dp) :: HET(NSPEC,8)
  !$OMP THREADPRIVATE( HET )

  ! Array for photolysis rates (increase size if necessary)
  REAL(dp) :: PHOTOL(1000)
  !$OMP THREADPRIVATE( PHOTOL )

  TYPE, PUBLIC :: HetState
     REAL(dp) :: AVO            ! Avogadro's constant              [molec/mol  ]4
     LOGICAL  :: natSurface     ! Is there NAT in this box?        [T/F        ]4
     LOGICAL  :: pscBox         ! Are there polar strat clouds?    [T/F        ]4
     LOGICAL  :: stratBox       ! Are we in the stratosphere       [T/F        ]4
     INTEGER  :: NAEROTYPE      ! Number of aerosol types          [1          ]4
     LOGICAL  :: is_UCX         ! Are we using the UCX mechanism?  [T/F        ]4
     REAL(dp) :: aClArea        ! Fine SSA+SNA aerosol area        [cm2/cm3    ]4
     REAL(dp) :: aClRadi        ! Fine SSA+SNA aerosol radius      [cm         ]4
     REAL(dp) :: aClVol         ! Fine SSA+SNA aerosol volume      [cm3/cm3    ]4
     REAL(dp) :: aIce           ! Ice surface area                 [cm2/cm3    ]4
     REAL(dp) :: aLiq           ! Liquid surface area              [cm2/cm3    ]4
     REAL(dp) :: aWater(2)      ! ISORROPIA aerosol water (fine & coarse)
     REAL(dp) :: Br_branch_CldA ! Br- branch ratio in CldA path    [1          ]4
     REAL(dp) :: Br_branch_CldC ! Br- branch ratio in CldC path    [1          ]4
     REAL(dp) :: Br_branch_CldG ! Br- branch ratio in CldG path    [1          ]4
     REAL(dp) :: Br_conc_CldA   ! Br- in cloud (A=fine sea salt  ) [mol/kg H2O ]4
     REAL(dp) :: Br_conc_CldC   ! Br- in cloud (C=coarse sea salt) [mol/kg H2O ]4
     REAL(dp) :: Br_conc_CldG   ! Br- in cloud (G=gas-phase      ) [mol/kg H2O ]4
     REAL(dp) :: Br_conc_Cld    ! Br- total in cloud = A + C + G
     REAL(dp) :: Br_conc_SALA   ! Br- in fine sea salt aerosol     [mol/kg H2O ]4
     REAL(dp) :: Br_conc_SALC   ! Br- in coarse sea salt aerosol   [mol/kg H2O ]4
     REAL(dp) :: Br_over_Cl_Cld ! Br_conc_Cld / Cl_conc_Cld        [1          ]4
     REAL(dp) :: Cl_branch_CldA ! Cl- branch ratio in CldA path    [1          ]4
     REAL(dp) :: Cl_branch_CldC ! Cl- branch ratio in CldC path    [1          ]4
     REAL(dp) :: Cl_branch_CldG ! Cl- Branch ratio in CldG path    [1          ]4
     REAL(dp) :: Cl_conc_CldA   ! Cl- in cloud (A=fine sea salt  ) [mol/kg H2O ]4
     REAL(dp) :: Cl_conc_CldC   ! Cl- in cloud (C=coarse sea salt) [mol/kg H2O ]4
     REAL(dp) :: Cl_conc_CldG   ! Cl- in cloud (G=gas-phase      ) [mol/kg H2O ]4
     REAL(dp) :: Cl_conc_Cld    ! Cl- total = A + C + G
     REAL(dp) :: Cl_conc_SALA   ! Cl- in fine   sea salt           [mol/kg H2O ]4
     REAL(dp) :: Cl_conc_SALC   ! Cl- in coarse sea salt           [mol/kg H2O ]4
     REAL(dp) :: cldFr          ! Cloud fraction                   [1          ]4
     REAL(dp) :: clearFr        ! Clear sky fraction               [1          ]4
     REAL(dp) :: frac_SALACL    ! Frac of SALACL / total fine SS   [1          ]4
     REAL(dp) :: fupdateHOBr    !
     REAL(dp) :: fupdateHOCl    !
     REAL(dp) :: gamma_HO2      ! Uptake probability for HO2       [1          ]4
     REAL(dp) :: H2O            ! H2O concentration
     REAL(dp) :: HBr_theta      ! HBr theta for uptake on ice
     REAL(dp) :: HCl_theta      ! HCl theta for uptake on ice
     REAL(dp) :: H_conc_ICl     ! Liquid phase pH, Cl-             [pH units   ]4
     REAL(dp) :: H_conc_LCl     ! Liquid phase pH, Cl-             [pH units   ]4
     REAL(dp) :: H_conc_SSA     ! Liquid phase pH, fine sea salt   [pH units   ]4
     REAL(dp) :: H_conc_SSC     ! Liquid phase pH, coarse sea salt [pH units   ]4
     REAL(dp) :: H_conc_Sul     ! Liquid phase pH, sulfate
     REAL(dp) :: HNO3_theta     ! HNO3 theta for uptake on ice
     REAL(dp) :: HSO3_conc_Cld  !
     REAL(dp) :: H_plus         ! Proton activity [1] and H+ conc  [M          ]4
     REAL(dp) :: KHETI_SLA(11)  ! Probs for PSC uptk rxns on SLA   [1          ]4
     REAL(dp) :: mHSO4          ! Bisulfate concentration          [M          ]4
     REAL(dp) :: mNO3           ! Nitrate concentration            [M          ]4
     REAL(dp) :: mSO4           ! Sulfate concentration            [M          ]4
     REAL(dp) :: NIT_conc_SALA  ! Cl- in fine sea salt             [mol/kg H2O ]4
     REAL(dp) :: NIT_conc_SALC  ! Cl- in coarse sea salt           [mol/kg H2O ]4
     REAL(dp) :: PI             ! PI constant                      [1          ]4
     REAL(dp) :: pHCloud        ! Cloud PH                         [pH units   ]4
     REAL(dp) :: pHSSA(2)       ! Sea salt pH (1=fine, 2=coarse)   [pH units   ]4
     REAL(dp) :: OMOC_POA       ! Org matter/orgc carbon in POA    [1          ]4
     REAL(dp) :: OMOC_OPOA      ! Org matter/org carbon in POA     [1          ]4
     REAL(dp) :: qIce           ! Ice mixing ratio                 [kg/kg      ]4
     REAL(dp) :: qLIq           ! Water mixing ratio               [kg/kg      ]4
     REAL(dp) :: rIce           ! Ice radius
     REAL(dp) :: rLiq           ! Liquid radius
     REAL(dp) :: SO3_conc_Cld   !
     REAL(dp) :: ssAlk(2)       ! Sea salt alk'nty (1=fine, 2=coarse)
     LOGICAL  :: ssFineIsAlk    ! Is fine sea-salt alkaline?       [T/F        ]4
     LOGICAL  :: ssFineIsAcid   ! Is fine sea-salt alkaline?       [T/F        ]4
     LOGICAL  :: ssCoarseIsAlk  ! Is coarse sea-salt alkaline?     [T/F        ]4
     LOGICAL  :: ssCoarseIsAcid ! Is coarse sea-salt acid?         [T/F        ]4
     REAL(dp) :: vAir           ! Volume of air                    [cm3        ]4
     REAL(dp) :: vIce           ! Ice volume                       [cm3        ]4
     REAL(dp) :: vLiq           ! Liquid volume                    [cm3        ]4
     REAL(dp) :: xArea(14)      ! Aerosol specific sfc area        [cm3/cm3 air]4
     REAL(dp) :: xH2O(14)       ! Aerosol water content            [cm3/cm3 air]4
     REAL(dp) :: xRadi(14)      ! Aerosol effective radius         [cm         ]4
     REAL(dp) :: xVol(14)       ! Aerosol specific volume          [cm3/cm3 air]4
  END TYPE HetState
  TYPE(HetState), TARGET, PUBLIC :: State_Het
  !$OMP THREADPRIVATE( State_Het )

! INLINED global variable declarations


END MODULE gckpp_Global

